#!/usr/bin/env -S zsh -c 'echo "Not a user script. source(aka .) only"'

BASE_SHELL=${BASE_SHELL:-${SHELL##*/}}

SZ_NOMUX=${SZ_NOMUX:-0}

if [ "${SZ_NOMUX:-0}" -ne 1 ]; then 
       [ "$TERM_PROGRAM" != 'vscode' ] \
    && [ "$TERM_PROGRAM" != 'Tabby' ] \
    && [ "$WAVETERM" != 1 ] \
    && [ -z "${VSCODE_PROFILE_INITIALIZED}" ] \
    || SZ_NOMUX=1
fi

if [ -n "${TTY}" ] && [ -r "${TTY}" ]; then
    printf "$TTY" > ~/.cache/login_tty
fi
[ -r "~/.cache/login_tty" ] && export TTY="$(~/.cache/login_tty)" || true

[[ -n "${DBG}" ]] && printf '%s=%s\n' \
    SZ_NOMUX "${SZ_NOMUX}" \
    TERM_PROGRAM "${TERM_PROGRAM}" \
    VSCODE_PROFILE_INITIALIZED "${VSCODE_PROFILE_INITIALIZED}"

# vim: set ft=sh expandtab tabstop=4 shiftwidth=4:
